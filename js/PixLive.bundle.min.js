"use strict";var pixliveModule=angular.module("pixlive",[]);pixliveModule.directive("pxlView",["$timeout","$ionicPosition","$ionicPlatform","$ionicBackdrop",function(a,b,c,d){return{restrict:"E",require:"^?ionNavView",priority:800,compile:function(e,f){function g(a,b,c,d){var e=a.$parent;a.$watch(function(){return(e.$hasHeader?" has-header":"")+(e.$hasSubheader?" has-subheader":"")+(e.$hasFooter?" has-footer":"")+(e.$hasSubfooter?" has-subfooter":"")+(e.$hasTabs?" has-tabs":"")+(e.$hasTabsTop?" has-tabs-top":"")},function(a,c){b.removeClass(c),b.addClass(a)})}function h(f,g,h,i){f.$on("$ionicView.beforeEnter",function(a,b){f.arView&&f.arView.beforeEnter()}),f.$on("$ionicView.afterEnter",function(h,i){f.arView?(f.onResize(),f.arView.afterEnter()):c.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.PixLive&&(e.children().remove(),f.pixliveTimeout=a(function(){var a=b.offset(g),c=a.top,e=a.left,h=a.width,i=a.height;f.pixliveTimeout=null,f.arView=window.cordova.plugins.PixLive.createARView(e,c,h,i,!0),null!=d.isDisplayed()&&f.arView.disableTouch(),f.onResize=function(){var a=b.offset(g),c=a.top,d=a.left,e=a.width,h=a.height;f.arView.resize(d,c,e,h)},f.onModalShown=function(){f.arView.disableTouch()},f.onModalHidden=function(){f.arView.enableTouch()},ionic.on("resize",f.onResize,window),ionic.on("backdrop.shown",f.onModalShown,window),ionic.on("backdrop.hidden",f.onModalHidden,window)},300))})}),f.$on("$ionicView.beforeLeave",function(b,c){f.pixliveTimeout&&(a.cancel(f.pixliveTimeout),f.pixliveTimeout=null),f.arView&&f.arView.beforeLeave()}),f.$on("$ionicView.afterLeave",function(a,b){f.arView&&f.arView.afterLeave()}),f.$on("$destroy",function(){f.pixliveTimeout&&(a.cancel(f.pixliveTimeout),f.pixliveTimeout=null),f.arView&&(ionic.off("resize",f.onResize,window),f.arView.destroy()),f.onModalShown&&(ionic.off("backdrop.shown",f.onModalShown,window),f.onModalShown=null),f.onModalHidden&&(ionic.off("backdrop.hidden",f.onModalHidden,window),f.onModalHidden=null)})}return e.addClass("scroll-content ionic-scroll scroll-content-false"),{pre:g,post:h}}}}]).config(["$provide",function(a){a.decorator("$ionicBackdrop",["$delegate",function(a){var b=a.retain,c=a.release;return a.backdropHolds=0,a.retain=function(){var c=[].slice.call(arguments);b.apply(null,c),a.backdropHolds++,1==a.backdropHolds&&ionic.trigger("backdrop.shown",{target:window})},a.release=function(){var b=[].slice.call(arguments);c.apply(null,b),a.backdropHolds--,0==a.backdropHolds&&ionic.trigger("backdrop.hidden",{target:window})},a.isDisplayed=function(){return a.backdropHolds>0},a}])}]),pixliveModule.factory("PxlRemoteController",["$timeout","$ionicPlatform","$q",function(a,b,c){return{synchronize:function(a){var d=c.defer();return b.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.PixLive?window.cordova.plugins.PixLive.synchronize(a,function(a){d.resolve(a)},function(a){d.reject(a)}):d.resolve([])}),d.promise}}}]);