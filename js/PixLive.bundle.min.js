"use strict";var pixliveModule=angular.module("pixlive",[]);pixliveModule.directive("pxlView",["$timeout","$ionicPosition","$ionicPlatform","$ionicBackdrop",function(a,b,c,d){return{restrict:"E",require:"^?ionNavView",priority:800,compile:function(e,f){function g(a,b,c,d){var e=a.$parent;a.$watch(function(){return(e.$hasHeader?" has-header":"")+(e.$hasSubheader?" has-subheader":"")+(e.$hasFooter?" has-footer":"")+(e.$hasSubfooter?" has-subfooter":"")+(e.$hasTabs?" has-tabs":"")+(e.$hasTabsTop?" has-tabs-top":"")},function(a,c){b.removeClass(c),b.addClass(a)})}function h(e,f,g,h){e.$on("$ionicView.beforeEnter",function(a,b){e.arView&&e.arView.beforeEnter()}),e.$on("$ionicView.afterEnter",function(g,h){e.arView?(e.onResize(),e.arView.afterEnter()):c.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.PixLive&&(e.pixliveTimeout=a(function(){var a=b.offset(f),c=a.top,g=a.left,h=a.width,i=a.height;e.pixliveTimeout=null,e.arView=window.cordova.plugins.PixLive.createARView(g,c,h,i,!0),0!=d.isDisplayed()?e.arView.disableTouch():e.arView.enableTouch(),e.onResize=function(){var a=b.offset(f),c=a.top,d=a.left,g=a.width,h=a.height;e.arView.resize(d,c,g,h)},e.onModalShown=function(){e.arView.disableTouch()},e.onModalHidden=function(){e.arView.enableTouch()},e.transferShown=function(){ionic.trigger("transfer.shown",{target:window})},e.transferHidden=function(){ionic.trigger("transfer.hidden",{target:window})},ionic.on("resize",e.onResize,window),ionic.on("backdrop.shown",e.onModalShown,window),ionic.on("backdrop.hidden",e.onModalHidden,window),e.$on("popover.shown",e.transferShown),e.$on("popover.hidden",e.transferHidden)},300))})}),e.$on("$ionicView.beforeLeave",function(b,c){e.pixliveTimeout&&(a.cancel(e.pixliveTimeout),e.pixliveTimeout=null),e.arView&&e.arView.beforeLeave()}),e.$on("$ionicView.afterLeave",function(a,b){e.arView&&e.arView.afterLeave()}),e.$on("$destroy",function(){e.pixliveTimeout&&(a.cancel(e.pixliveTimeout),e.pixliveTimeout=null),e.arView&&(ionic.off("resize",e.onResize,window),e.arView.destroy()),e.onModalShown&&(ionic.off("backdrop.shown",e.onModalShown,window),e.onModalShown=null),e.onModalHidden&&(ionic.off("backdrop.hidden",e.onModalHidden,window),e.onModalHidden=null)})}return e.addClass("scroll-content ionic-scroll scroll-content-false"),{pre:g,post:h}}}}]).config(["$provide",function(a){a.decorator("$ionicBackdrop",["$delegate",function(a){var b=a.retain,c=a.release;return a.backdropHolds=0,a.addBackdropHolds=function(){a.backdropHolds++,1==a.backdropHolds&&ionic.trigger("backdrop.shown",{target:window})},a.removeBackdropHolds=function(){a.backdropHolds--,0==a.backdropHolds&&ionic.trigger("backdrop.hidden",{target:window})},ionic.on("transfer.shown",a.addBackdropHolds,window),ionic.on("transfer.hidden",a.removeBackdropHolds,window),a.retain=function(){var c=[].slice.call(arguments);b.apply(null,c),a.addBackdropHolds()},a.release=function(){var b=[].slice.call(arguments);c.apply(null,b),a.removeBackdropHolds()},a.isDisplayed=function(){return a.backdropHolds>0},a}])}]),pixliveModule.factory("PxlRemoteController",["$ionicPlatform","$q","PxlEventService",function(a,b,c){return{synchronize:function(d){var e=b.defer(),f=function(a){e.notify(100*a.progress)};return c.addListener("syncProgress",f),a.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.PixLive?window.cordova.plugins.PixLive.synchronize(d,function(a){c.removeListener("syncProgress",f),e.resolve(a)},function(a){c.removeListener("syncProgress",f),e.reject(a)}):(c.removeListener("syncProgress",f),e.resolve([]))}),e.promise}}}]),pixliveModule.factory("PxlController",["$ionicPlatform","$q",function(a,b){return{presentNotificationsList:function(){var c=b.defer();return a.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.PixLive?window.cordova.plugins.PixLive.presentNotificationsList(function(){c.resolve()},function(){c.reject()}):c.resolve([])}),c.promise},getContexts:function(){var c=b.defer();return a.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.PixLive?window.cordova.plugins.PixLive.getContexts(function(a){c.resolve(a)},function(){c.reject()}):c.resolve([])}),c.promise}}}]),pixliveModule.constant("PxlEventService",function(){var a={},b=function(b){if(b.type&&a[b.type])for(var c=a[b.type].length-1;c>=0;c--)a[b.type][c](b)};return{handler:b,addListener:function(b,c){a[b]||(a[b]=[]),a[b].push(c)},removeListener:function(b,c){if(a[b]&&0!=a[b].length){var d=a[b].indexOf(c);-1!=d&&a[b].splice(d,1)}}}}()).run(["PxlEventService","$ionicPlatform",function(a,b){b.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.PixLive&&!window.cordova.plugins.PixLive.onEventReceived&&(cordova.plugins.PixLive.onEventReceived=a.handler)})}]).directive("pxlContextEnter",["PxlEventService",function(a){return{link:function(b,c,d){var e=function(a){b.$apply(function(b){b[d.pxlContextEnter](a.context)})};a.addListener("enterContext",e),c.bind("$destroy",function(){a.removeListener("enterContext",e)})}}}]).directive("pxlContextExit",["PxlEventService",function(a){return{link:function(b,c,d){var e=function(a){b.$apply(function(b){b[d.pxlContextExit](a.context)})};a.addListener("exitContext",e),c.bind("$destroy",function(){a.removeListener("exitContext",e)})}}}]).directive("pxlCodeRecognize",["PxlEventService",function(a){return{link:function(b,c,d){var e=function(a){b.$apply(function(b){b[d.pxlCodeRecognize](a.code)})};a.addListener("codeRecognize",e),c.bind("$destroy",function(){a.removeListener("codeRecognize",e)})}}}]).directive("pxlAnnotationsPresent",["PxlEventService",function(a){return{link:function(b,c,d){var e=function(a){b.$apply(function(a){a[d.pxlAnnotationsPresent]()})};a.addListener("presentAnnotations",e),c.bind("$destroy",function(){a.removeListener("presentAnnotations",e)})}}}]).directive("pxlAnnotationsHide",["PxlEventService",function(a){return{link:function(b,c,d){var e=function(a){b.$apply(function(a){a[d.pxlAnnotationsHide]()})};a.addListener("hideAnnotations",e),c.bind("$destroy",function(){a.removeListener("hideAnnotations",e)})}}}]).directive("pxlSynchronizationRequired",["PxlEventService",function(a){return{link:function(b,c,d){var e=function(a){b.$apply(function(b){b[d.pxlSynchronizationRequired](a.tags)})};a.addListener("requireSync",e),c.bind("$destroy",function(){a.removeListener("requireSync",e)})}}}]);