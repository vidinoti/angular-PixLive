<!doctype html><html>  <head>    <meta charset="utf-8">    <base href="../">    <title>JSDoc: source : PixLiveEvent.js</title>    <link type="text/css" rel="stylesheet" href="css/jsdoc-default.css">    <link href="css/prettify-tomorrow.css" type="text/css" rel="stylesheet">    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,400,300,700" rel="stylesheet" type="text/css">    <link href="css/custom.css" type="text/css" rel="stylesheet">    <script src="js/prettify.js"></script>    <script src="js/angular.min.js"></script>  </head>  <body ng-app="">    <nav>      <h2><a href="index.html">Index</a></h2>      <ul class="module">        <!-- pixlive -->        <h3>          <a href="" ng-click="modulepixlive = !modulepixlive">            module: pixlive          </a>          <i ng-cloak="" ng-show="modulepixlive">+</i>        </h3>        <li id="pixlive" ng-hide="modulepixlive">          <ul class="group">            <h3>              <a href="" ng-click="pixliveundefined = !pixliveundefined">                undefined              </a>              <i ng-cloak="" ng-show="pixliveundefined">+</i>            </h3>            <ul ng-hide="pixliveundefined">              <li>                <a href="pixlive.Context.html">Context</a>              </li>            </ul>          </ul><ul class="group">            <h3>              <a href="" ng-click="pixlivedirective = !pixlivedirective">                directive              </a>              <i ng-cloak="" ng-show="pixlivedirective">+</i>            </h3>            <ul ng-hide="pixlivedirective">              <li>                <a href="pixlive.eventFromContent.html">eventFromContent</a>              </li><li>                <a href="pixlive.pxlAnnotationsHide.html">pxlAnnotationsHide</a>              </li><li>                <a href="pixlive.pxlAnnotationsPresent.html">pxlAnnotationsPresent</a>              </li><li>                <a href="pixlive.pxlCodeRecognize.html">pxlCodeRecognize</a>              </li><li>                <a href="pixlive.pxlContextEnter.html">pxlContextEnter</a>              </li><li>                <a href="pixlive.pxlContextExit.html">pxlContextExit</a>              </li><li>                <a href="pixlive.pxlSensorTriggered.html">pxlSensorTriggered</a>              </li><li>                <a href="pixlive.pxlSensorUntriggered.html">pxlSensorUntriggered</a>              </li><li>                <a href="pixlive.pxlSensorUpdate.html">pxlSensorUpdate</a>              </li><li>                <a href="pixlive.pxlSynchronizationRequired.html">pxlSynchronizationRequired</a>              </li><li>                <a href="pixlive.pxlView.html">pxlView</a>              </li>            </ul>          </ul><ul class="group">            <h3>              <a href="" ng-click="pixliveservice = !pixliveservice">                service              </a>              <i ng-cloak="" ng-show="pixliveservice">+</i>            </h3>            <ul ng-hide="pixliveservice">              <li>                <a href="pixlive.PxlController.html">PxlController</a>              </li><li>                <a href="pixlive.PxlEventService.html">PxlEventService</a>              </li><li>                <a href="pixlive.PxlRemoteController.html">PxlRemoteController</a>              </li>            </ul>          </ul>        </li>      </ul>    </nav>    <div id="content" class="page-wrap">      <h1 class="title">        source : PixLiveEvent.js      </h1>      <div id="main" class="big-container">        <!-- source code html -->        <article>          <pre class="prettyprint source linenums"><code>/*
 * angular-pixlive v1
 * (c) 2015-2016 Vidinoti https://vidinoti.com
 * License: MIT
 *
 * Event directives
 *
 */
'use strict';
pixliveModule
    /**
     * @memberof pixlive
     * @ngdoc service
     * @name PxlEventService
     * @description 
     *   Add / Remove event subscribers to PixLive SDK related events.
     *
     *   **Note:** You should use the plugin's directive (like `pxlContextEnter`) instead of using this service directly.
     */
    .constant('PxlEventService', (function() {
        var eventListeners={};
        var handler = function(event) {
            if(event.type && eventListeners[event.type]) {
                for(var i = eventListeners[event.type].length-1; i>=0; i--) {
                    eventListeners[event.type][i](event);
                }
            }
        };
        return {
            handler: handler,
            /**
             * Add a new listener for the provided event type. 
             * 
             * @memberof PxlEventService
             * @param {string} event The event to register for. See the [cordova-plugin-PixLive](https://github.com/vidinoti/cordova-plugin-PixLive) plugin for more info on the event types.
             * @param {function} callback The function to be called when the provided event is generated.
             */
            addListener: function(event, callback) {
                if(!eventListeners[event]) {
                    eventListeners[event]=[];
                }
                eventListeners[event].push(callback);
            },
            /**
             * Remove an existing listener for the provided event type. 
             * 
             * @memberof PxlEventService
             * @param {string} event The event to register for. See the [cordova-plugin-PixLive](https://github.com/vidinoti/cordova-plugin-PixLive) plugin for more info on the event types.
             * @param {function} callback The function that has been passed to the `addListener(event, callback)` method.
             */
            removeListener: function(event, callback) {
                if(!eventListeners[event] || eventListeners[event].length == 0) {
                    return;
                }
                var index = eventListeners[event].indexOf(callback);
                if(index==-1)
                    return;
                eventListeners[event].splice(index,1);
            }
        };
    })())
    .run(['PxlEventService', '$ionicPlatform', function(PxlEventService, $ionicPlatform) {
        //We make sure the event service is executed and loaded.
        $ionicPlatform.ready(function() {
            if (window.cordova && window.cordova.plugins && window.cordova.plugins.PixLive && !window.cordova.plugins.PixLive.onEventReceived) {
                cordova.plugins.PixLive.onEventReceived = PxlEventService.handler;
            }
        });
    }])
    /**
     * @ngdoc directive
     * @name pxlContextEnter
     * @element Attribute
     * @memberof pixlive
     * @param {service} PxlEventService PixLive SDK Event service
     * @restrict A
     *
     * @description
     * Expression that is evaluated when a context is entered. Such an event 
     * happens when a context is linked with a beacon and you are getting close 
     * to the beacon, or when an image is linked with such a context and this image has been recognized.
     *
     * The unique ID of the context is passed as a parameter.
     *
     * @example
     * &lt;div pxl-context-enter="contextEnter(contextId)">
     *  ...
     * &lt;/div>
     */
    .directive('pxlContextEnter', [
        'PxlEventService',
        function(PxlEventService) {
            return {
                restrict: 'A',
                link: function(scope, element, attrs) {
                    var listener = function(event) {
                        scope.$apply(function(self) {
                            self[attrs.pxlContextEnter](event.context);
                        });
                    };
                    PxlEventService.addListener('enterContext',listener);
                    element.bind('$destroy', function() {
                        PxlEventService.removeListener('enterContext',listener);
                    });
                }
            };
        }
    ])
    /**
     * @ngdoc directive
     * @name pxlContextExit
     * @element Attribute
     * @memberof pixlive
     * @param {service} PxlEventService PixLive SDK Event service
     * @restrict A
     *
     * @description
     * Expression that is evaluated when a context is exited. Such an event 
     * happens when a context is linked with a beacon and you are getting away 
     * from the beacon, or when an image is linked with such a context and this image is not 
     * within the camera sight anymore.
     *
     * The unique ID of the context is passed as a parameter.
     *
     * @example
     * &lt;div pxl-context-enter="contextExit(contextId)">
     *  ...
     * &lt;/div>
     */
    .directive('pxlContextExit', [
        'PxlEventService',
        function(PxlEventService) {
            return {
                restrict: 'A',
                link: function(scope, element, attrs) {
                    var listener = function(event) {
                        scope.$apply(function(self) {
                            self[attrs.pxlContextExit](event.context);
                        });
                    };
                    PxlEventService.addListener('exitContext',listener);
                    element.bind('$destroy', function() {
                        PxlEventService.removeListener('exitContext',listener);
                    });
                }
            };
        }
    ])
    /**
     * @ngdoc directive
     * @name eventFromContent
     * @element Attribute
     * @memberof pixlive
     * @param {service} PxlEventService PixLive SDK Event service
     * @restrict A
     *
     * @description
     * Expression that is evaluated when an event is received from the content (PixliveJS).
     * To dispatch an event from PixLiveJS use: device.dispatchEventInApp(eventName, eventParams);
     *
     * event.eventName The name of the event
     * event.eventParams The parameters of the event
     * @example
     * &lt;div pxl-context-enter="eventFromContent(eventName,eventParams)">
     *  ...
     * &lt;/div>
     */
    .directive('pxlEventFromContent', [
        'PxlEventService',
        function(PxlEventService) {
            return {
                restrict: 'A',
                link: function(scope, element, attrs) {
                    var listener = function(event) {
                        scope.$apply(function(self) {
                            self[attrs.pxlEventFromContent](event.eventName,event.eventParams);
                        });
                    };
                    PxlEventService.addListener('eventFromContent',listener);
                    element.bind('$destroy', function() {
                        PxlEventService.removeListener('eventFromContent',listener);
                    });
                }
            };
        }
    ])
    /**
     * @ngdoc directive
     * @name pxlSensorTriggered
     * @element Attribute
     * @memberof pixlive
     * @param {service} PxlEventService PixLive SDK Event service
     * @restrict A
     *
     * @description
     * Expression that is evaluated when a sensor state become triggered (i.e. active).
     *
     * The ID of the sensor and the type of sensor are passed as parameters. The types and IDs are defined hereafter.
     * 
     * Three types of sensors are defined:
     *  1. `Vision`&lt;br/>
     *      Corresponds to an image that has been recognized. As of today, the sensor ID corresponds 
     *      to the context ID to which the sensor is linked but this might change in the future as the 
     *      PixLive SDK does support any kind of IDs.
     *  2. `iBeacon`&lt;br/>
     *      Corresponds to an iBeacon that is in the required proximity of the smartphone. The ID is defined to be:
     *      ```
     *      BeaconUUID_Major_Minor
     *      ```
     *  3. `VidiBeacon`&lt;br/>
     *      Corresponds to a VidiBeacon that is in the required proximity of the smartphone. 
     *      The ID is defined to be the VidiBeacon serial.
     *
     * @example
     * &lt;div pxl-sensor-triggered="sensorTriggered(sensorId, sensorType)">
     *  ...
     * &lt;/div>
     */
    .directive('pxlSensorTriggered', [
        'PxlEventService',
        function(PxlEventService) {
            return {
                restrict: 'A',
                link: function(scope, element, attrs) {
                    var listener = function(event) {
                        scope.$apply(function(self) {
                            self[attrs.pxlSensorTriggered](event.sensorId,event.sensorType);
                        });
                    };
                    PxlEventService.addListener('sensorTriggered',listener);
                    element.bind('$destroy', function() {
                        PxlEventService.removeListener('sensorTriggered',listener);
                    });
                }
            };
        }
    ])
    /**
     * @ngdoc directive
     * @name pxlSensorUpdate
     * @element Attribute
     * @memberof pixlive
     * @param {service} PxlEventService PixLive SDK Event service
     * @restrict A
     *
     * @description
     * Expression that is evaluated when a sensor parameter changes.
     *
     * The ID of the sensor, the type of sensor, and the sensor parameters are passed as parameters. The types and IDs are defined hereafter.
     * 
     * Three types of sensors are defined:
     *  1. `Vision`&lt;br/>
     *      Corresponds to an image that has been recognized. As of today, this sensor never gets updated.
     *  2. `iBeacon`&lt;br/>
     *      Corresponds to an iBeacon that is in the required proximity of the smartphone. The ID is defined to be:
     *      ```
     *      BeaconUUID_Major_Minor
     *      ```
     *      
     *      The sensor object contains the following two properties:
     *        * `rssi`: The RSSI in dbm of the received beacon signal
     *        * `distance`: The estimated distance in meters between the beacon and the smartphone
     *          
     *  3. `VidiBeacon`&lt;br/>
     *      Corresponds to a VidiBeacon that is in the required proximity of the smartphone. 
     *      The ID is defined to be the VidiBeacon serial.
     *
     *      The sensor object contains the following property:
     *        * `rssi`: The RSSI in dbm of the received beacon signal
     *
     * @example
     * &lt;div pxl-sensor-update="sensorUpdate(sensorId, sensorType, sensor)">
     *  ...
     * &lt;/div>
     */
    .directive('pxlSensorUpdate', [
        'PxlEventService',
        function(PxlEventService) {
            return {
                restrict: 'A',
                link: function(scope, element, attrs) {
                    var listener = function(event) {
                        scope.$apply(function(self) {
                            self[attrs.pxlSensorUpdate](event.sensorId,event.sensorType, event);
                        });
                    };
                    PxlEventService.addListener('sensorUpdate',listener);
                    element.bind('$destroy', function() {
                        PxlEventService.removeListener('sensorUpdate',listener);
                    });
                }
            };
        }
    ])
    /**
     * @ngdoc directive
     * @name pxlSensorUntriggered
     * @element Attribute
     * @memberof pixlive
     * @param {service} PxlEventService PixLive SDK Event service
     * @restrict A
     *
     * @description
     * Expression that is evaluated when a sensor state become untriggered (i.e. not anymore active).
     *
     * The ID of the sensor and the type of sensor are passed as parameters. The types and IDs are defined hereafter.
     * 
     * Three types of sensors are defined:
     *  1. `Vision`&lt;br/>
     *      Corresponds to an image that has been recognized. As of today, the sensor ID corresponds 
     *      to the context ID to which the sensor is linked but this might change in the future as the 
     *      PixLive SDK does support any kind of IDs.
     *  2. `iBeacon`&lt;br/>
     *      Corresponds to an iBeacon that is in the required proximity of the smartphone. The ID is defined to be:
     *      ```
     *      BeaconUUID_Major_Minor
     *      ```
     *  3. `VidiBeacon`&lt;br/>
     *      Corresponds to a VidiBeacon that is in the required proximity of the smartphone. 
     *      The ID is defined to be the VidiBeacon serial.
     *
     * @example
     * &lt;div pxl-sensor-triggered="sensorUntriggered(sensorId, sensorType)">
     *  ...
     * &lt;/div>
     */
    .directive('pxlSensorUntriggered', [
        'PxlEventService',
        function(PxlEventService) {
            return {
                restrict: 'A',
                link: function(scope, element, attrs) {
                    var listener = function(event) {
                        scope.$apply(function(self) {
                            self[attrs.pxlSensorUntriggered](event.sensorId,event.sensorType);
                        });
                    };
                    PxlEventService.addListener('sensorUntriggered',listener);
                    element.bind('$destroy', function() {
                        PxlEventService.removeListener('sensorUntriggered',listener);
                    });
                }
            };
        }
    ])
    /**
     * @ngdoc directive
     * @name pxlCodeRecognize
     * @element Attribute
     * @memberof pixlive
     * @param {service} PxlEventService PixLive SDK Event service
     * @restrict A
     *
     * @description
     * Expression that is evaluated when a code (QR Code, Barcode etc..) is recognized by the PixLive SDK
     *
     * The code value (e.g. the URL in case of a QR Code with URL) is passed as parameter.
     *
     * *Note*: You have to enable Code recognition on the SDK for this method to be called.
     * 
     *
     * @example
     * &lt;div pxl-code-recognize="codeRec(codeValue)">
     *  ...
     * &lt;/div>
     */
    .directive('pxlCodeRecognize', [
        'PxlEventService',
        function(PxlEventService) {
            return {
                restrict: 'A',
                link: function(scope, element, attrs) {
                    var listener = function(event) {
                        scope.$apply(function(self) {
                            self[attrs.pxlCodeRecognize](event.code);
                        });
                    };
                    PxlEventService.addListener('codeRecognize',listener);
                    element.bind('$destroy', function() {
                        PxlEventService.removeListener('codeRecognize',listener);
                    });
                }
            };
        }
    ])
    /**
     * @ngdoc directive
     * @name pxlAnnotationsPresent
     * @element Attribute
     * @memberof pixlive
     * @param {service} PxlEventService PixLive SDK Event service
     * @restrict A
     *
     * @description
     * Expression that is evaluated when some augmented reality content is presented on screen.
     *
     * This gives you the opportunity to hide any overlay you may have added over the Augmented Reality (AR) view.
     *
     * *Note*: This method is only called when the AR view is displayed.
     * 
     * @example
     * &lt;div pxl-annotations-present="hideOverlay()">
     *  ...
     * &lt;/div>
     */
    .directive('pxlAnnotationsPresent', [
        'PxlEventService',
        function(PxlEventService) {
            return {
                restrict: 'A',
                link: function(scope, element, attrs) {
                    var listener = function(event) {
                        scope.$apply(function(self) {
                            self[attrs.pxlAnnotationsPresent]();
                        });
                    };
                    PxlEventService.addListener('presentAnnotations',listener);
                    element.bind('$destroy', function() {
                        PxlEventService.removeListener('presentAnnotations',listener);
                    });
                }
            };
        }
    ])
    /**
     * @ngdoc directive
     * @name pxlAnnotationsHide
     * @element Attribute
     * @memberof pixlive
     * @param {service} PxlEventService PixLive SDK Event service
     * @restrict A
     *
     * @description
     * Expression that is evaluated when no more augmented reality content is present on screen.
     *
     * This gives you the opportunity to put back any overlay you may have added over the Augmented Reality (AR) view.
     *
     * *Note*: This method is only called when the AR view is displayed.
     * 
     * @example
     * &lt;div pxl-annotations-hide="showOverlay()">
     *  ...
     * &lt;/div>
     */
    .directive('pxlAnnotationsHide', [
        'PxlEventService',
        function(PxlEventService) {
            return {
                restrict: 'A',
                link: function(scope, element, attrs) {
                    var listener = function(event) {
                        scope.$apply(function(self) {
                            self[attrs.pxlAnnotationsHide]();
                        });
                    };
                    PxlEventService.addListener('hideAnnotations',listener);
                    element.bind('$destroy', function() {
                        PxlEventService.removeListener('hideAnnotations',listener);
                    });
                }
            };
        }
    ])
    /**
     * @ngdoc directive
     * @name pxlSynchronizationRequired
     * @element Attribute
     * @memberof pixlive
     * @param {service} PxlEventService PixLive SDK Event service
     * @restrict A
     *
     * @description
     * Expression that is evaluated when a context synchronization is required.
     *
     * You should then call the RemoteController to trigger the synchronization with the passed tags (and any others you might want to add).
     *
     * The tags array to synchronize the app with, is passed as parameter (`tags`in the example below)
     *
     * @example
     * &lt;div pxl-synchronization-required="doSync(tags)">
     *  ...
     * &lt;/div>
     */
    .directive('pxlSynchronizationRequired', [
        'PxlEventService',
        function(PxlEventService) {
            return {
                restrict: 'A',
                link: function(scope, element, attrs) {
                    var listener = function(event) {
                        scope.$apply(function(self) {
                            self[attrs.pxlSynchronizationRequired](event.tags);
                        });
                    };
                    PxlEventService.addListener('requireSync',listener);
                    element.bind('$destroy', function() {
                        PxlEventService.removeListener('requireSync',listener);
                    });
                }
            };
        }
    ])
    ;</code></pre>        </article>        <!-- index.html -->        <!-- class files -->      </div>      <footer style="clear:both">        Documentation generated by        <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.2</a>        using        <a href="https://github.com/allenhwkim/angular-jsdoc">Angular-JSDoc template</a>      </footer>    </div>    <!--%= prettyJson %-->    <script>      prettyPrint();      var lineNo = window.location.hash.match(/#line([0-9]+)$/);      lineNo && document.querySelector("ol li:nth-child("+(lineNo[1])+")").scrollIntoView();    </script>  </body></html>